<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - SMPN SATU ATAP TUBAKI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        :root { --blue-dark: #1e3a5f; --blue-light: #00509d; --bg-light: #f4f7f6; --white: #ffffff; --danger: #e74c3c; --success: #27ae60; --warning: #f39c12; --info: #17a2b8; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { display: flex; background: var(--bg-light); }

        /* Sidebar */
        .sidebar { width: 280px; background: var(--blue-dark); color: white; min-height: 100vh; position: fixed; padding: 20px 0; z-index: 100; }
        .sidebar h2 { text-align: center; font-size: 1.2rem; margin-bottom: 30px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 15px; letter-spacing: 1px; }
        .sidebar nav a { display: block; padding: 15px 25px; color: #bdc3c7; text-decoration: none; transition: 0.3s; font-size: 0.95rem; cursor: pointer; }
        .sidebar nav a i { margin-right: 15px; width: 20px; text-align: center; }
        .sidebar nav a:hover, .sidebar nav a.active { background: rgba(255,255,255,0.1); color: white; border-left: 4px solid #b8860b; }
        .logout-btn { margin-top: 20px; color: #ff7675 !important; border-top: 1px solid rgba(255,255,255,0.1); }

        /* Main Content */
        .main-content { margin-left: 280px; width: calc(100% - 280px); padding: 30px; }
        header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        
        /* Panel System */
        .panel { display: none; }
        .panel.active { display: block; animation: fadeIn 0.4s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Stats & Cards */
        .stats-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 20px; border-radius: 12px; display: flex; align-items: center; gap: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .stat-card i { font-size: 2.5rem; color: var(--blue-dark); }
        .stat-card h3 { font-size: 1.8rem; color: var(--blue-dark); }
        .stat-card p { font-size: 0.85rem; color: #7f8c8d; }

        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        table th { background: #f8f9fa; color: var(--blue-dark); padding: 12px; text-align: left; font-size: 0.9rem; }
        table td { padding: 12px; border-bottom: 1px solid #eee; font-size: 0.85rem; vertical-align: middle; }
        
        .btn { padding: 8px 15px; border: none; border-radius: 6px; cursor: pointer; text-decoration: none; font-size: 0.8rem; font-weight: 600; display: inline-flex; align-items: center; gap: 8px; transition: 0.2s; }
        .btn-wa { background: #25d366; color: white; }
        .btn-del { background: var(--danger); color: white; }
        .btn-view { background: var(--blue-light); color: white; }
        .btn-info { background: var(--info); color: white; }
        .btn-excel { background: var(--success); color: white; }
        .btn-save { background: var(--success); color: white; margin-top: 10px; }
        .btn:hover { opacity: 0.8; transform: scale(1.02); }

        .btn-group { display: flex; gap: 5px; }

        .admin-form { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; background: #f9f9f9; padding: 20px; border-radius: 8px; margin-bottom: 20px; }
        .admin-form input, .admin-form textarea, .admin-form select { padding: 10px; border: 1px solid #ddd; border-radius: 5px; width: 100%; font-size: 0.9rem; }
        .admin-form .full-width { grid-column: span 2; }
        .table-img { width: 80px; height: 50px; object-fit: cover; border-radius: 4px; border: 1px solid #ddd; }
        
        .running-text-area { background: #fff3cd; border: 1px solid #ffeeba; border-radius: 10px; padding: 20px; margin-top: 20px; }
    </style>
</head>
<body>

    <aside class="sidebar">
        <h2>PANEL KONTROL</h2>
        <nav id="admin-nav">
            <a href="#" data-target="dash" class="active"><i class="fas fa-chart-line"></i> Dashboard</a>
            <a href="#" data-target="sambutan-panel"><i class="fas fa-comment-dots"></i> Sambutan Kepsek</a>
            <a href="#" data-target="prestasi"><i class="fas fa-trophy"></i> Prestasi Siswa</a>
            <a href="#" data-target="osis-panel"><i class="fas fa-users-cog"></i> Kelola OSIS</a>
            <a href="#" data-target="ekskul-panel"><i class="fas fa-volleyball-ball"></i> Kelola Ekskul</a>
            <a href="#" data-target="ppdb"><i class="fas fa-user-graduate"></i> Pengelolaan PPDB</a>
            <a href="#" data-target="berita"><i class="fas fa-newspaper"></i> Berita & Artikel</a>
            <a href="#" data-target="pengumuman"><i class="fas fa-bullhorn"></i> Pengumuman</a>
            <a href="#" data-target="guru"><i class="fas fa-user-tie"></i> Data Guru</a>
            <a href="#" data-target="slider"><i class="fas fa-images"></i> Slider Hero</a>
            <a href="#" data-target="galeri"><i class="fas fa-photo-video"></i> Galeri</a>
            <a href="#" data-target="brosur-panel"><i class="fas fa-file-image"></i> Kelola Brosur</a>
            <a href="#" data-target="stats-panel"><i class="fas fa-calculator"></i> Kelola Statistik</a>
            <a href="/logout" class="logout-btn"><i class="fas fa-sign-out-alt"></i> Logout</a>
        </nav>
    </aside>

    <main class="main-content">
        <header>
            <div>
                <h2 id="current-title">Dashboard Overview</h2>
                <p style="font-size: 0.8rem; color: #666;">Administrator SMPN SATU ATAP TUBAKI</p>
            </div>
            <img src="/gambar/logo1.png" alt="Logo" height="40">
        </header>

        <div id="dash" class="panel active">
            <div class="stats-container">
                <div class="stat-card">
                    <i class="fas fa-users"></i>
                    <div><h3><%= daftarPendaftar.length %></h3><p>Pendaftar</p></div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-newspaper"></i>
                    <div><h3><%= daftarBerita.length %></h3><p>Berita</p></div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-bullhorn"></i>
                    <div><h3><%= daftarPengumuman.length %></h3><p>Pengumuman</p></div>
                </div>
            </div>

            <div class="card" style="border-left: 5px solid var(--blue-dark);">
                <div class="card-header">
                    <h3><i class="fas fa-comment-dots"></i> Sambutan Kepala Sekolah (Quick View)</h3>
                    <a href="#" class="btn btn-view" onclick="openPanel('sambutan-panel')">
                        <i class="fas fa-edit"></i> Edit Lengkap
                    </a>
                </div>
                <div style="display: flex; gap: 20px; align-items: flex-start;">
                    <img src="/gambar/<%= sambutan.foto %>" style="width: 100px; height: 120px; object-fit: cover; border-radius: 8px; border: 1px solid #ddd;" onerror="this.src='/gambar/default.jpg'">
                    <div>
                        <h4 style="color: var(--blue-dark); margin-bottom: 5px;"><%= sambutan.nama_kepsek %></h4>
                        <p style="font-size: 0.85rem; color: #555; line-height: 1.5;">
                            <%= sambutan.isi.substring(0, 200) %>...
                        </p>
                    </div>
                </div>
            </div>

            <div class="card running-text-area">
                <div class="card-header" style="border-bottom-color: #ffeeba;">
                    <h3 style="color: #856404;"><i class="fas fa-bullhorn"></i> Pengaturan Running Text (Teks Berjalan)</h3>
                </div>
                <form action="/admin/update-running-text" method="POST">
                    <div class="form-group">
                        <label style="display:block; margin-bottom: 8px; font-weight: 600;">Pesan Pengumuman:</label>
                        <textarea name="pesan" class="form-control" rows="3" style="width: 100%; padding: 12px; border-radius: 8px; border: 1px solid #decba1;" placeholder="Masukkan pesan pengumuman di sini..."><%= runningText.pesan %></textarea>
                    </div>
                    <button type="submit" class="btn btn-save">
                        <i class="fas fa-save"></i> Simpan Running Text
                    </button>
                </form>
            </div>

            <div class="card mt-4">
                <h3>Selamat Datang, Admin</h3>
                <p>Gunakan menu di samping kiri untuk mengelola konten sekolah. Fitur <strong>Running Text</strong> di atas dapat digunakan untuk memberikan informasi darurat atau pengumuman penting.</p>
            </div>
        </div>

        <div id="sambutan-panel" class="panel">
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-user-tie"></i> Edit Sambutan Kepala Sekolah</h3>
                </div>
                <form action="/admin/update-sambutan" method="POST" enctype="multipart/form-data" class="admin-form">
                    <div class="full-width">
                        <label>Nama Kepala Sekolah:</label>
                        <input type="text" name="nama_kepsek" value="<%= sambutan.nama_kepsek %>" required>
                    </div>
                    <div class="full-width">
                        <label>Isi Sambutan:</label>
                        <textarea name="isi_sambutan" rows="10" required><%= sambutan.isi %></textarea>
                    </div>
                    <div class="full-width">
                        <label>Foto Kepala Sekolah (Kosongkan jika tidak diganti):</label>
                        <input type="file" name="foto_kepsek" accept="image/*">
                        <p style="font-size: 0.8rem; color: #888; margin-top: 5px;">Foto saat ini: <%= sambutan.foto %></p>
                    </div>
                    <button type="submit" class="btn btn-view full-width">
                        <i class="fas fa-save"></i> Simpan Perubahan Sambutan
                    </button>
                </form>
            </div>
        </div>

        <div id="prestasi" class="panel">
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-plus-circle"></i> Tambah Prestasi Baru</h3>
                </div>
                <form action="/admin/prestasi/tambah" method="POST" enctype="multipart/form-data" class="admin-form">
                    <input type="text" name="judul" placeholder="Judul / Nama Lomba" required>
                    <input type="text" name="pemenang" placeholder="Nama Pemenang / Siswa" required>
                    <select name="kategori" required>
                        <option value="">-- Pilih Kategori --</option>
                        <option value="Akademik">Akademik</option>
                        <option value="Non-Akademik">Non-Akademik</option>
                        <option value="Olahraga">Olahraga</option>
                        <option value="Seni">Seni</option>
                    </select>
                    <div class="full-width">
                        <label>Foto Prestasi:</label>
                        <input type="file" name="gambar" accept="image/*" required>
                    </div>
                    <button type="submit" class="btn btn-view full-width">
                        <i class="fas fa-upload"></i> Simpan Prestasi
                    </button>
                </form>
                <hr style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">
                <h3>Daftar Prestasi</h3>
                <table>
                    <thead>
                        <tr><th>Gambar</th><th>Judul</th><th>Pemenang</th><th>Kategori</th><th>Aksi</th></tr>
                    </thead>
                    <tbody>
                        <% if (typeof daftarPrestasi !== 'undefined' && daftarPrestasi.length > 0) { %>
                            <% daftarPrestasi.forEach(pres => { %>
                                <tr>
                                    <td><img src="/gambar/prestasi/<%= pres.gambar %>" class="table-img" onerror="this.src='/gambar/default-prestasi.jpg'"></td>
                                    <td><strong><%= pres.judul %></strong></td>
                                    <td><%= pres.pemenang %></td>
                                    <td><%= pres.kategori %></td>
                                    <td>
                                        <a href="/admin/prestasi/hapus/<%= pres.id %>" class="btn btn-del" onclick="return confirm('Hapus data prestasi ini?')">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </td>
                                </tr>
                            <% }) %>
                        <% } else { %>
                            <tr><td colspan="5" style="text-align: center;">Belum ada data prestasi.</td></tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="osis-panel" class="panel">
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-sitemap"></i> Struktur Pengurus OSIS</h3>
                </div>
                <form action="/admin/osis/struktur/tambah" method="POST" enctype="multipart/form-data" class="admin-form">
                    <input type="text" name="nama" placeholder="Nama Lengkap" required>
                    <input type="text" name="jabatan" placeholder="Jabatan" required>
                    <div class="full-width">
                        <label>Foto Pengurus:</label>
                        <input type="file" name="foto_pengurus" accept="image/*" required>
                    </div>
                    <button type="submit" class="btn btn-view full-width">Simpan Pengurus</button>
                </form>
                <h3>Daftar Pengurus</h3>
                <table>
                    <thead>
                        <tr><th>Foto</th><th>Nama</th><th>Jabatan</th><th>Aksi</th></tr>
                    </thead>
                    <tbody>
                        <% if (typeof strukturOsis !== 'undefined' && strukturOsis.length > 0) { %>
                            <% strukturOsis.forEach(s => { %>
                                <tr>
                                    <td><img src="/gambar/osis/struktur/<%= s.foto %>" class="table-img" style="width:50px; height:50px; border-radius:50%"></td>
                                    <td><%= s.nama %></td>
                                    <td><%= s.jabatan %></td>
                                    <td>
                                        <a href="/admin/osis/struktur/hapus/<%= s.id %>" class="btn btn-del" onclick="return confirm('Hapus pengurus ini?')"><i class="fas fa-trash"></i></a>
                                    </td>
                                </tr>
                            <% }) %>
                        <% } %>
                    </tbody>
                </table>
            </div>

            <form action="/admin/osis/kegiatan/tambah" method="POST" enctype="multipart/form-data" class="admin-form">
    <input type="text" name="nama_kegiatan" placeholder="Nama Kegiatan" required>
    
    <input type="date" name="tanggal" required>
    
    <textarea name="deskripsi" placeholder="Deskripsi Kegiatan..." class="full-width" rows="3"></textarea>
    
    <div class="full-width">
        <label>Gambar Kegiatan:</label>
        <input type="file" name="gambar_kegiatan" accept="image/*" required>
    </div>
    
    <button type="submit" class="btn btn-success full-width" style="background-color: var(--success); color: white;">
        <i class="fas fa-plus"></i> Tambah Kegiatan
    </button>
</form>
                <h3 style="margin-top: 20px;">Daftar Kegiatan OSIS</h3>
                <table>
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Nama Kegiatan</th>
                            <th>Gambar</th>
                            <th>Tanggal</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (typeof kegiatanOsis !== 'undefined' && kegiatanOsis.length > 0) { %>
                            <% kegiatanOsis.forEach((kegiatan, index) => { %>
                            <tr>
                                <td><%= index + 1 %></td>
                                <td><strong><%= kegiatan.nama_kegiatan %></strong></td>
                                <td>
                                    <img src="/gambar/osis/kegiatan/<%= kegiatan.gambar %>" class="table-img" style="width: 60px;">
                                </td>
                                <td><%= new Date(kegiatan.tanggal).toLocaleDateString('id-ID') %></td>
                                <td>
                                    <a href="/admin/osis/kegiatan/hapus/<%= kegiatan.id %>" class="btn btn-del" onclick="return confirm('Hapus kegiatan ini?')">
                                        <i class="fas fa-trash"></i> Hapus
                                    </a>
                                </td>
                            </tr>
                            <% }) %>
                        <% } else { %>
                            <tr><td colspan="5" style="text-align: center;">Belum ada data kegiatan OSIS.</td></tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="ekskul-panel" class="panel">
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-plus-circle"></i> Tambah Kegiatan Ekstrakurikuler</h3>
                </div>
                <form action="/admin/tambah-ekskul" method="POST" enctype="multipart/form-data" class="admin-form">
                    <input type="text" name="nama_ekskul" placeholder="Nama Ekstrakurikuler (Contoh: Pramuka)" class="full-width" required>
                    <textarea name="deskripsi" placeholder="Deskripsi atau jadwal kegiatan..." class="full-width" rows="3" required></textarea>
                    <div class="full-width">
                        <label>Foto Kegiatan:</label>
                        <input type="file" name="file_upload" accept="image/*" required>
                    </div>
                    <button type="submit" class="btn btn-view full-width">Simpan Ekstrakurikuler</button>
                </form>
                <hr style="margin: 30px 0; border: 1px solid #eee;">
                <h3>Daftar Ekstrakurikuler</h3>
                <table>
                    <thead>
                        <tr><th>Foto</th><th>Nama Ekskul</th><th>Deskripsi</th><th>Aksi</th></tr>
                    </thead>
                    <tbody>
                        <% if (typeof daftarEkskul !== 'undefined' && daftarEkskul.length > 0) { %>
                            <% daftarEkskul.forEach(e => { %>
                                <tr>
                                    <td><img src="/gambar/galeri/<%= e.gambar %>" class="table-img"></td>
                                    <td><strong><%= e.nama %></strong></td>
                                    <td><%= e.deskripsi.substring(0, 50) %>...</td>
                                    <td>
                                        <a href="/admin/hapus-ekskul/<%= e.id %>" class="btn btn-del" onclick="return confirm('Hapus ekskul ini?')">
                                            <i class="fas fa-trash"></i>
                                        </a>
                                    </td>
                                </tr>
                            <% }) %>
                        <% } else { %>
                            <tr><td colspan="4" style="text-align: center;">Belum ada data ekstrakurikuler.</td></tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="ppdb" class="panel">
            <div class="card">
                <div class="card-header">
                    <h3>Daftar Calon Siswa</h3>
                    <a href="/admin/ekspor-ppdb" class="btn btn-excel">
                        <i class="fas fa-file-excel"></i> Ekspor ke Excel
                    </a>
                </div>
                <table>
                    <thead>
                        <tr><th>Tgl Daftar</th><th>Nama Lengkap</th><th>Asal Sekolah</th><th>Dokumen</th><th>Aksi</th></tr>
                    </thead>
                    <tbody>
                        <% if (daftarPendaftar.length > 0) { %>
                            <% daftarPendaftar.forEach(siswa => { %>
                                <tr>
                                    <td><%= new Date(siswa.tgl_daftar).toLocaleDateString('id-ID') %></td>
                                    <td><strong><%= siswa.nama_lengkap %></strong></td>
                                    <td><%= siswa.sekolah_asal %></td>
                                    <td>
                                        <% if (siswa.dokumen) { %>
                                            <div class="btn-group">
                                                <a href="/uploads/docs/<%= siswa.dokumen %>" target="_blank" class="btn btn-sm btn-info" title="Lihat"><i class="fas fa-eye"></i></a>
                                                <a href="/uploads/docs/<%= siswa.dokumen %>" download class="btn btn-sm btn-view" title="Unduh"><i class="fas fa-download"></i></a>
                                            </div>
                                        <% } else { %>
                                            <span class="text-muted">No File</span>
                                        <% } %>
                                    </td>
                                    <td>
                                        <div class="btn-group">
                                            <a href="https://wa.me/<%= siswa.whatsapp %>" target="_blank" class="btn btn-wa"><i class="fab fa-whatsapp"></i> Chat</a>
                                            <a href="/admin/hapus-ppdb/<%= siswa.id %>" class="btn btn-del" onclick="return confirm('Hapus pendaftar ini?')"><i class="fas fa-trash"></i></a>
                                        </div>
                                    </td>
                                </tr>
                            <% }) %>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="berita" class="panel">
            <div class="card">
                <h3>Tambah Berita & Artikel</h3>
                <form action="/admin/tambah-berita" method="POST" enctype="multipart/form-data" class="admin-form">
                    <input type="text" name="judul" placeholder="Judul Berita" class="full-width" required>
                    <textarea name="isi" placeholder="Isi Berita..." class="full-width" rows="5" required></textarea>
                    <input type="file" name="gambar_berita" accept="image/*" class="full-width" required>
                    <button type="submit" class="btn btn-view full-width">Posting Berita</button>
                </form>
                <table>
                    <thead><tr><th>Gambar</th><th>Judul</th><th>Aksi</th></tr></thead>
                    <tbody>
                        <% daftarBerita.forEach(b => { %>
                            <tr>
                                <td><img src="/gambar/<%= b.gambar %>" class="table-img"></td>
                                <td><%= b.judul %></td>
                                <td><a href="/admin/hapus-berita/<%= b.id %>" class="btn btn-del"><i class="fas fa-trash"></i></a></td>
                            </tr>
                        <% }) %>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="pengumuman" class="panel">
            <div class="card">
                <h3>Upload Pengumuman (PDF)</h3>
                <form action="/admin/tambah-pengumuman" method="POST" enctype="multipart/form-data">
                    <input type="text" name="judul" placeholder="Judul Pengumuman" required style="width: 100%; padding: 10px; margin-bottom: 10px;">
                    <input type="file" name="file_pdf" accept=".pdf" required style="margin-bottom: 10px;"> 
                    <button type="submit" class="btn btn-view full-width">Simpan Pengumuman</button>
                </form>
                <hr style="margin: 20px 0;">
                <table>
                    <thead><tr><th>Nama Pengumuman</th><th>Aksi</th></tr></thead>
                    <tbody>
                        <% daftarPengumuman.forEach(p => { %>
                            <tr>
                                <td><i class="fas fa-file-pdf" style="color: #e74c3c;"></i> <%= p.judul %></td>
                                <td><a href="/admin/hapus-pengumuman/<%= p.id %>" class="btn btn-del"><i class="fas fa-trash"></i></a></td>
                            </tr>
                        <% }) %>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="guru" class="panel">
    <div class="card">
        <div class="card-header">
            <h3><i class="fas fa-user-tie"></i> Kelola Data Guru & Staf</h3>
        </div>
        
        <form action="/admin/tambah-guru" method="POST" enctype="multipart/form-data" class="admin-form">
            <input type="text" name="nama" placeholder="Nama Lengkap beserta Gelar" required>
            <input type="text" name="jabatan" placeholder="Jabatan (Contoh: Guru Matematika)" required>
            
            <select name="kategori" required>
                <option value="" disabled selected>-- Pilih Kategori --</option>
                <option value="pendidik">Tenaga Pendidik (Guru)</option>
                <option value="kependidikan">Tenaga Kependidikan (Staf/TU)</option>
            </select>

            <div class="full-width">
                <label>Foto Guru/Staf:</label>
                <input type="file" name="foto" accept="image/*">
            </div>
            
            <button type="submit" class="btn btn-view full-width">
                <i class="fas fa-save"></i> Simpan Data
            </button>
        </form>

        <hr>

        <h4 style="margin-top: 20px; color: #2c3e50;"><i class="fas fa-chalkboard-teacher"></i> Daftar Tenaga Pendidik</h4>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Foto</th>
                        <th>Nama</th>
                        <th>Jabatan</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (daftarGuru && daftarGuru.length > 0) { %>
                        <% daftarGuru.forEach(guru => { %>
                            <tr>
                                <td><img src="/gambar/<%= guru.foto %>" width="50"></td>
                                <td><%= guru.nama %></td>
                                <td><%= guru.jabatan %></td>
                                <td>
                                    <a href="/admin/hapus-guru/<%= guru.id %>" class="btn btn-delete" onclick="return confirm('Hapus data ini?')">Hapus</a>
                                </td>
                            </tr>
                        <% }) %>
                    <% } else { %>
                        <tr><td colspan="4">Data Pendidik belum ada.</td></tr>
                    <% } %>
                </tbody>
            </table>
        </div>

        <hr>

        <h4 style="margin-top: 20px; color: #2c3e50;"><i class="fas fa-id-card"></i> Daftar Tenaga Kependidikan (Staf)</h4>
        <div class="table-responsive">
            <table>
                <thead>
                    <tr>
                        <th>Foto</th>
                        <th>Nama</th>
                        <th>Jabatan</th>
                        <th>Aksi</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (daftarStaf && daftarStaf.length > 0) { %>
                        <% daftarStaf.forEach(staf => { %>
                            <tr>
                                <td><img src="/gambar/<%= staf.foto %>" width="50"></td>
                                <td><%= staf.nama %></td>
                                <td><%= staf.jabatan %></td>
                                <td>
                                    <a href="/admin/hapus-guru/<%= staf.id %>" class="btn btn-delete" onclick="return confirm('Hapus data ini?')">Hapus</a>
                                </td>
                            </tr>
                        <% }) %>
                    <% } else { %>
                        <tr><td colspan="4">Data Staf belum ada.</td></tr>
                    <% } %>
                </tbody>
            </table>
        </div>
    </div>
</div>

        <div id="slider" class="panel">
            <div class="card">
                <h3>Upload Slider Beranda</h3>
                <form action="/admin/tambah-slider" method="POST" enctype="multipart/form-data" class="admin-form">
                    <input type="text" name="judul" placeholder="Judul Gambar" class="full-width" required>
                    <input type="text" name="sub_judul" placeholder="Sub Judul" class="full-width">
                    <input type="file" name="gambar_slider" accept="image/*" class="full-width" required>
                    <button type="submit" class="btn btn-view full-width">Upload Slider</button>
                </form>
                <table>
                    <thead><tr><th>Gambar</th><th>Judul</th><th>Aksi</th></tr></thead>
                    <tbody>
                        <% daftarSlider.forEach(s => { %>
                            <tr>
                                <td><img src="/gambar/<%= s.gambar %>" class="table-img"></td>
                                <td><%= s.judul %></td>
                                <td><a href="/admin/hapus-slider/<%= s.id %>" class="btn btn-del"><i class="fas fa-trash"></i></a></td>
                            </tr>
                        <% }) %>
                    </tbody>
                </table>
            </div>
        </div>

        <div id="galeri" class="panel">
    <div class="card mb-4">
        <div class="card-header">
            <h3><i class="fas fa-images"></i> Tambah Konten Galeri</h3>
        </div>
        <div class="card-body">
            <form action="/admin/tambah-galeri" method="POST" enctype="multipart/form-data">
                <div class="mb-3">
                    <label>Judul Konten</label>
                    <input type="text" name="judul" class="form-control" required placeholder="Masukkan judul foto atau video">
                </div>

                <div class="mb-3">
                    <label>Tipe Konten</label>
                    <select name="tipe" id="tipe_konten" class="form-control" onchange="toggleInput()">
                        <option value="foto">Foto</option>
                        <option value="video">Video (YouTube)</option>
                    </select>
                </div>

                <div id="input_gambar" class="mb-3">
                    <label>Pilih Gambar</label>
                    <input type="file" name="gambar_galeri" class="form-control">
                    <small class="text-muted">Gunakan format .jpg, .png, atau .webp</small>
                </div>

                <div id="input_video" class="mb-3" style="display: none;">
                    <label>Link Video YouTube</label>
                    <input type="text" name="link_video" class="form-control" placeholder="Contoh: https://www.youtube.com/watch?v=xxxx">
                    <small class="text-danger">*Pastikan link YouTube valid</small>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Simpan Galeri
                </button>
            </form>
        </div>
    </div>

    <div class="card">
        <div class="card-header">
            <h3><i class="fas fa-list"></i> Daftar Galeri</h3>
        </div>
        <div class="card-body">
            <div class="table-responsive">
                <table class="table table-striped table-bordered">
                    <thead class="table-dark">
                        <tr>
                            <th>ID</th>
                            <th>Judul</th>
                            <th>Tipe</th>
                            <th>Preview</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (daftarGaleri && daftarGaleri.length > 0) { %>
                            <% daftarGaleri.forEach(galeri => { %>
                                <tr>
                                    <td><%= galeri.id %></td>
                                    <td><%= galeri.judul %></td>
                                    <td>
                                        <span class="badge <%= galeri.tipe === 'foto' ? 'bg-success' : 'bg-info' %>">
                                            <%= galeri.tipe %>
                                        </span>
                                    </td>
                                    <td>
                                        <% if(galeri.tipe === 'foto') { %>
                                            <img src="/gambar/galeri/<%= galeri.gambar %>" width="80" class="img-thumbnail">
                                        <% } else { %>
                                            <small class="text-muted"><%= galeri.link_video %></small>
                                        <% } %>
                                    </td>
                                    <td>
                                        <a href="/admin/hapus-galeri/<%= galeri.id %>" 
                                           class="btn btn-danger btn-sm" 
                                           onclick="return confirm('Apakah Anda yakin ingin menghapus foto ini?')">
                                            <i class="fas fa-trash"></i> Hapus
                                        </a>
                                    </td>
                                </tr>
                            <% }) %>
                        <% } else { %>
                            <tr>
                                <td colspan="5" class="text-center">Belum ada data galeri.</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div> <script>
function toggleInput() {
    const tipe = document.getElementById('tipe_konten').value;
    const inputGambar = document.getElementById('input_gambar');
    const inputVideo = document.getElementById('input_video');

    if (tipe === 'video') {
        inputGambar.style.display = 'none';
        inputVideo.style.display = 'block';
        inputGambar.querySelector('input').value = "";
    } else {
        inputGambar.style.display = 'block';
        inputVideo.style.display = 'none';
        inputVideo.querySelector('input').value = "";
    }
}
document.addEventListener("DOMContentLoaded", toggleInput);
</script>
        <div id="brosur-panel" class="panel">
            <div class="card">
                <div class="card-header">
                    <h3><i class="fas fa-plus-circle"></i> Tambah Brosur Baru</h3>
                </div>
                <form action="/admin/tambah-brosur" method="POST" enctype="multipart/form-data" class="admin-form">
                    <div class="full-width">
                        <label>Judul/Nama Brosur:</label>
                        <input type="text" name="judul" placeholder="Contoh: Brosur PPDB 2026" required>
                    </div>
                    <div class="full-width">
                        <label>Pilih Gambar Brosur:</label>
                        <input type="file" name="file_brosur" accept="image/*" required>
                    </div>
                    <button type="submit" class="btn btn-view full-width">
                        <i class="fas fa-upload"></i> Unggah Brosur
                    </button>
                </form>

                <hr style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">
                
                <h3>Daftar Brosur Aktif</h3>
                <table>
                    <thead>
                        <tr>
                            <th>No</th>
                            <th>Judul</th>
                            <th>Pratinjau</th>
                            <th>Aksi</th>
                        </tr>
                    </thead>
                    <tbody>
                        <% if (typeof daftarBrosur !== 'undefined' && daftarBrosur.length > 0) { %>
                            <% daftarBrosur.forEach((b, index) => { %>
                                <tr>
                                    <td><%= index + 1 %></td>
                                    <td><strong><%= b.judul %></strong></td>
                                    <td>
                                        <img src="/gambar/brosur/<%= b.gambar %>" class="table-img" style="width: 100px; height: auto;">
                                    </td>
                                    <td>
                                        <a href="/admin/hapus-brosur/<%= b.id %>" class="btn btn-del" onclick="return confirm('Apakah Anda yakin ingin menghapus brosur ini?')">
                                            <i class="fas fa-trash"></i> Hapus
                                        </a>
                                    </td>
                                </tr>
                            <% }) %>
                        <% } else { %>
                            <tr>
                                <td colspan="4" style="text-align: center; padding: 20px;" class="text-muted">Belum ada brosur yang diunggah.</td>
                            </tr>
                        <% } %>
                    </tbody>
                </table>
            </div>
        </div>
    
        <div id="stats-panel" class="panel">
            <div class="card">
                <h3><i class="fas fa-edit"></i> Update Angka Statistik</h3>
                <form action="/admin/update-statistik" method="POST" class="admin-form">
                    <div><label>Ruang Belajar</label><input type="number" name="ruang" required value="<%= typeof stats !== 'undefined' ? stats.ruang_belajar : '' %>"></div>
                    <div><label>Tenaga Pendidik</label><input type="number" name="guru" required value="<%= typeof stats !== 'undefined' ? stats.tenaga_pendidik : '' %>"></div>
                    <div><label>Tenaga Kependidikan</label><input type="number" name="staf" required value="<%= typeof stats !== 'undefined' ? stats.tenaga_kependidikan : '' %>"></div>
                    <div><label>Murid</label><input type="number" name="murid" required value="<%= typeof stats !== 'undefined' ? stats.murid : '' %>"></div>
                    <button type="submit" class="btn btn-view full-width">Update Statistik</button>
                </form>
            </div>
        </div>
        
    </main>

    <script>
        // Navigasi Sidebar
        const navLinks = document.querySelectorAll('#admin-nav a[data-target]');
        const panels = document.querySelectorAll('.panel');
        const titleEl = document.getElementById('current-title');

        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                if (link.classList.contains('logout-btn')) return;
                e.preventDefault();
                const targetId = link.getAttribute('data-target');

                panels.forEach(p => p.classList.remove('active'));
                navLinks.forEach(l => l.classList.remove('active'));

                document.getElementById(targetId).classList.add('active');
                link.classList.add('active');
                titleEl.innerText = link.innerText.trim();
            });
        });

        function openPanel(id) {
            const link = document.querySelector(`[data-target="${id}"]`);
            if (link) link.click();
        }

        function switchGaleriInput() {
            const tipe = document.getElementById('tipeGaleri').value;
            document.getElementById('boxFoto').style.display = (tipe === 'foto' ? 'block' : 'none');
            document.getElementById('boxVideo').style.display = (tipe === 'video' ? 'block' : 'none');
        }
    </script>
</body>
</html>